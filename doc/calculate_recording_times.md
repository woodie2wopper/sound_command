# calculate_recording_times.py

録音ファイルの時間を集計するスクリプト

## 概要

指定されたディレクトリの直下のディレクトリ内の音声ファイル（.wav, .mp3）の録音時間を集計します。ファイル名から録音時間を解析し、ディレクトリごとの総録音時間、ファイル数、総容量、最終更新日時を計算します。

## ファイル名形式

- 基本形式: `YYMMDD_HHMMSS_HHMMSS` または `YYMMDD-HHMMSS-HHMMSS`
  - YYMMDD: 日付（年2桁、月2桁、日2桁）
  - HHMMSS: 時刻（時2桁、分2桁、秒2桁）
  - 最初の時刻: 録音開始時刻
  - 2番目の時刻: 録音終了時刻

## オプション

- `-h, --help`
  - ヘルプメッセージを表示

- `-v, --verbose`
  - 詳細な情報を表示
  - 除外されたファイルやディレクトリの情報
  - ffprobeで取得した録音時間の情報

- `-d, --directory`
  - 対象ディレクトリを指定
  - デフォルト: "./"
  - 指定されたディレクトリの直下のディレクトリのみを対象とする

- `-c, --filename-check`
  - ファイル名が666形式（6桁の時刻が3つ）になっていないファイルを表示
  - このオプション使用時は録音時間の集計は行わない

- `-e, --exclude`
  - 指定した文字列を含むファイルまたはディレクトリを除外
  - 例: `-e ORG`

- `-o6, --only-666`
  - 666形式のファイルのみを対象とする
  - ファイル名が666形式でないファイルはスキップ

## 出力形式

### 通常モード（-cなし）

```
ディレクトリ名                               総録音時間        ファイル数    総容量          最終更新
----------------------------------------------------------------------------------------------------
ディレクトリ1                                HH:MM:SS        N            X.XX GB        2024-01-01 12:34:56
ディレクトリ2                                HH:MM:SS        N            X.XX GB        2024-01-02 23:45:67
...
----------------------------------------------------------------------------------------------------
合計                                      総時間            総ファイル数  総容量
実行時間: X.XX秒
```

### ファイル名チェックモード（-c）

```
ファイルパス1
ファイルパス2
...
実行時間: X.XX秒
```

### 詳細モード（-v）

```
Info: 除外パターン 'XXX' に一致するため、ファイル 'YYY' をスキップしました
Info: ファイル 'ZZZ' の長さをffprobeで取得しました: HH:MM:SS
Warning: ファイル 'AAA' の形式が不正です
...
実行時間: X.XX秒
```

## 出力項目の説明

- ディレクトリ名: 対象ディレクトリの直下のディレクトリ名
- 総録音時間: ディレクトリ内の全音声ファイルの録音時間の合計（HH:MM:SS形式）
- ファイル数: ディレクトリ内の音声ファイルの総数
- 総容量: ディレクトリ内の全音声ファイルのサイズの合計（B, KB, MB, GB, TB単位で自動調整）
- 最終更新: ディレクトリ内の音声ファイルの最終更新日時（YYYY-MM-DD HH:MM:SS形式）
  - ファイルが存在しないディレクトリは「未更新」と表示

## 使用例

```bash
# 通常の時間集計
python calculate_recording_times.py

# 特定のディレクトリの時間集計（詳細表示）
python calculate_recording_times.py -v -d /path/to/directory

# ファイル名形式チェック
python calculate_recording_times.py -c

# ORGを含むファイルを除外
python calculate_recording_times.py -e ORG

# 666形式のファイルのみを対象とする
python calculate_recording_times.py -o6

# 666形式のファイルのみを対象とし、特定の文字列を含むファイルを除外
python calculate_recording_times.py -o6 -e ORG

# パイプを使用した例
python calculate_recording_times.py -c | sort
python calculate_recording_times.py -c | grep "特定の文字列"
```

## 注意事項

- ファイル名の時刻が24時を超える場合は、自動的に翌日として扱われます
- ファイル名から時刻を取得できない場合は、ffprobeを使用して音声ファイルの長さを取得します
- 指定されたディレクトリの直下のディレクトリのみを対象とし、その中のファイルは再帰的に処理されます
- 実行時間は秒単位で小数点以下2桁まで表示されます 