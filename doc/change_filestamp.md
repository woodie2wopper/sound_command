# change_timestamp.py 仕様書

## 概要
音声・動画ファイルのタイムスタンプ（最終更新時刻）を変更するためのコマンドラインツール。
絶対時間指定または相対時間指定が可能。

## 基本情報
- スクリプト名: change_timestamp.py
- 動作環境: Python3
- 依存関係: なし

## オプション
| オプション | 引数 | 説明 | デフォルト |
|------------|------|------|------------|
| -h, --help | なし | ヘルプメッセージを表示 | - |
| -e, --execute | なし | タイムスタンプを実際に変更（指定がない場合は表示のみ） | False |
| -t, --timestamp | date time | 絶対時刻を指定（例: 240305 183000） | - |
| -r, --relative | date time | 相対時間を指定（例: +010000 000000） | - |

## 使用例
```bash
# ヘルプの表示
change_timestamp.py -h

# 絶対時刻の指定（表示のみ）
change_timestamp.py -t 240305 183000 input.wav
# 出力例：
# Current timestamp: 2024-03-05 18:30:00
# New timestamp:     2024-03-05 18:30:00
# 警告: 変更を実行するには -e/--execute オプションが必要です

# 相対時間の指定（1年進める）
change_timestamp.py -e -r +010000 000000 input.wav
# 出力例：
# Current timestamp: 2024-03-05 18:30:00
# New timestamp:     2025-03-05 18:30:00
# タイムスタンプを変更しました: input.wav

# 相対時間の指定（1年戻す）
change_timestamp.py -e -r -010000 000000 input.wav

# 相対時間の指定（2時間30分進める）
change_timestamp.py -e -r +000000 023000 input.wav
```

## 入力形式
### 絶対時刻指定（-t, --timestamp）
- 日付: YYMMDD形式（例: 240305）
  - YY: 年の下2桁
  - MM: 月（01-12）
  - DD: 日（01-31）
- 時刻: HHMMSS形式（例: 183000）
  - HH: 時（00-23）
  - MM: 分（00-59）
  - SS: 秒（00-59）

### 相対時間指定（-r, --relative）
- 日付: ±YYMMDD形式（例: +010000）
  - ±: 符号（+/-）
  - YY: 年の差分
  - MM: 月の差分
  - DD: 日の差分
- 時刻: HHMMSS形式（例: 023000）
  - HH: 時の差分
  - MM: 分の差分
  - SS: 秒の差分

## エラーチェック
- 入力ファイルの存在確認
- 日付・時刻フォーマットの検証
- 日付の妥当性チェック（月の日数など）
- 実行モードとdry-runモードの同時指定チェック
- 絶対時刻と相対時間の同時指定チェック
- 相対時間指定の符号チェック

## 注意事項
1. ファイルの最終更新時刻が変更されます
2. 変更前にバックアップを取ることを推奨
3. 実行前に必ずdry-runで変更内容を確認
4. 絶対時刻指定の年は20XX年として解釈（例：24 → 2024）
5. 相対時間指定では符号の指定が必須（日付部分の先頭）

## 戻り値
- 0: 正常終了
- 1: 入力エラー（ファイルなし、不正な日時形式など）
- 2: 実行エラー（権限エラーなど）

## ログ
- 標準出力: 処理結果の表示
- 標準エラー出力: エラーメッセージ

## 制限事項
- 対象ファイルへの書き込み権限が必要
- タイムスタンプはシステムの制限に依存（通常1970年以降） 